Utility functions for version 1 and 2 and 3
